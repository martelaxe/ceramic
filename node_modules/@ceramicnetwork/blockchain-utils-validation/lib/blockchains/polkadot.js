"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const caip_1 = require("caip");
const util_crypto_1 = require("@polkadot/util-crypto");
const uint8arrays_1 = __importDefault(require("uint8arrays"));
const namespace = 'polkadot';
const stringHex = (str) => `0x${uint8arrays_1.default.toString(uint8arrays_1.default.fromString(str), 'base16')}`;
async function validateLink(proof) {
    const address = new caip_1.AccountID(proof.account).address;
    const message = stringHex(proof.message);
    const res = await util_crypto_1.signatureVerify(message, proof.signature, address);
    return res.isValid ? proof : null;
}
const Handler = {
    namespace,
    validateLink,
};
exports.default = Handler;
//# sourceMappingURL=polkadot.js.map